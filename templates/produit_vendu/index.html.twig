{% extends 'components/layout/default.html.twig' %}
{% block content %}
<div class="panel">
    <div class="panel-body">
        <form action="" class="flex d-flex inline-block">
            <div class="form-group p-2">
                <label for="start">Debut</label>
                <input type="date" name="start" class="form-input">
            </div>

            <div class="form-group p-2">
                <label for="end">Fin</label>
                <input type="date" name="end" class="form-input" value="{{ end|date('d-m-Y') }}">
            </div>
            <div class="form-group p-2">
                <label for=""> -</label>
                <input type="submit" value="Rechercher" class="btn btn-primary">
            </div>
            <div class="form-group p-2">
                <label for=""> -</label>
                <a href="{{ path("app_produit_vendu_index") }}" class="btn btn-primary"> Rafraichir</a>
            </div>
        </form>
    </div>
</div>
<div class="panel">
    <h1>Liste des Produits vendus du {{ start|date('d-m-Y H:i:s') }} au {{ end|date('d-m-Y  H:i:s') }}
    </h1>

    <table id="datatable" class="table">
        <thead>
            <tr>
                <th>Vente No</th>
                <th>Produit</th>
                <th>Qty</th>
                <th>Prix</th>
                <th>Total</th>
                <th>Date et heure</th>
                <th>Ops</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody id="myTable">
        {% set total = 0 %}
        {% set grandtotal = 0 %}

        {% for produit_vendu in produit_vendus %}
            <tr>
                <td>{{ produit_vendu.vente?'-'?produit_vendu.vente.numeroVente }}</td>
                <td>{{ produit_vendu.produit.designation }}</td>
                <td>{{ produit_vendu.qty }}</td>
                <td>{{ produit_vendu.PrixUnitaire }}</td>
                {% set total = produit_vendu.PrixUnitaire * produit_vendu.qty  %}
                {% set grandtotal = grandtotal + total %}
                <td>{{ total }}</td>
                <td>{{ produit_vendu.createdAt ? produit_vendu.createdAt|date('Y-m-d H:i:s') : '' }}</td>
                <td>{{ produit_vendu.createdBy }}</td>
                <td>
{#                    <a href="{{ path('app_produit_vendu_show', {'id': produit_vendu.id}) }}">show</a>#}
{#                    <a href="{{ path('app_produit_vendu_edit', {'id': produit_vendu.id}) }}">edit</a>#}
                </td>
            </tr>

        {% endfor %}
        </tbody>
    </table>
<strong>Grand-Total: {{ grandtotal }}</strong>
    </div>
{#    <a href="{{ path('app_produit_vendu_new') }}">Create new</a>#}
    <script src="{{ asset('assets/js/jquery.min.js') }}"></script>
    <script src="{{ asset('assets/js/datatables.js') }}"></script>
    <script>

        let table = new DataTable('#datatable', {
            order: [[0, 'desc']],
            language: {
                info: 'Page _PAGE_ / _PAGES_',
                infoEmpty: 'No records available',
                infoFiltered: '(filtered from _MAX_ total records)',
                lengthMenu: 'Afficher _MENU_ ligne par page',
                zeroRecords: 'Nothing found - sorry'
            },
            buttons: [
                'copy', 'excel', 'pdf'
            ]
        });
    </script>

    {% endblock %}
